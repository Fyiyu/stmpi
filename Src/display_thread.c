#include "display_thread.h"
#include "stm32f4xx_hal.h"
#include <rtthread.h>

extern SPI_HandleTypeDef hspi4;
extern LTDC_HandleTypeDef hltdc;


static void Write_3Spi_cmd(rt_uint8_t addr_h, rt_uint8_t addr_l)
{
    rt_uint8_t spi_data[2];
    spi_data[0] = 0x20;
    spi_data[1] = addr_h;
    HAL_SPI_Transmit(&hspi4, spi_data, 2, 10);

    spi_data[0] = 0x00;
    spi_data[1] = addr_l;
    HAL_SPI_Transmit(&hspi4, spi_data, 2, 10);
}

static void Write_3Spi_date(rt_uint8_t data)
{
    rt_uint8_t spi_data[2];
    spi_data[0] = 0x40;
    spi_data[1] = data;
    HAL_SPI_Transmit(&hspi4, spi_data, 2, 10);
}

static rt_uint8_t Read_3Spi_date(void)
{
    rt_uint8_t rxdata[2];    
    rt_uint8_t txdata[2];
    txdata[0] = 0xC0;
    txdata[1] = 0x00;
    HAL_SPI_TransmitReceive(&hspi4, txdata, rxdata, 2, 10);
    return rxdata[1];
}

void display_thread_entry(void *parameter)
{
    rt_kprintf("display thread started.\r\n");
    
    HAL_GPIO_WritePin(GPIOE, GPIO_PIN_3, GPIO_PIN_SET);
    rt_thread_mdelay(10);
    HAL_GPIO_WritePin(GPIOE, GPIO_PIN_3, GPIO_PIN_RESET);
    rt_thread_mdelay(50);
    HAL_GPIO_WritePin(GPIOE, GPIO_PIN_3, GPIO_PIN_SET);
    rt_thread_mdelay(150);
    
    Write_3Spi_cmd(0x04,0x00); rt_kprintf("reg_0400 = %02x\r\n",Read_3Spi_date());
    Write_3Spi_cmd(0x04,0x01); rt_kprintf("reg_0401 = %02x\r\n",Read_3Spi_date());
    Write_3Spi_cmd(0x04,0x02); rt_kprintf("reg_0402 = %02x\r\n",Read_3Spi_date());
    
    Write_3Spi_cmd(0xF0,0x00);	Write_3Spi_date(0x55);
	Write_3Spi_cmd(0xF0,0x01);	Write_3Spi_date(0xAA);
	Write_3Spi_cmd(0xF0,0x02);	Write_3Spi_date(0x52);
	Write_3Spi_cmd(0xF0,0x03);	Write_3Spi_date(0x08);
	Write_3Spi_cmd(0xF0,0x04);	Write_3Spi_date(0x01);

	//*************AVDD Set AVDD 5.2V*************//
	Write_3Spi_cmd(0xB0,0x00);	Write_3Spi_date(0x0D);
	Write_3Spi_cmd(0xB0,0x01);	Write_3Spi_date(0x0D);
	Write_3Spi_cmd(0xB0,0x02);	Write_3Spi_date(0x0D);

	//************AVDD ratio****************//
	Write_3Spi_cmd(0xB6,0x00);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xB6,0x01);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xB6,0x02);	Write_3Spi_date(0x34);
	 
	//************AVEE  -5.2V****************//
	Write_3Spi_cmd(0xB1,0x00);	Write_3Spi_date(0x0D);
	Write_3Spi_cmd(0xB1,0x01);	Write_3Spi_date(0x0D);
	Write_3Spi_cmd(0xB1,0x02);	Write_3Spi_date(0x0D);

	//***********AVEE ratio*************//
	Write_3Spi_cmd(0xB7,0x00);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xB7,0x01);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xB7,0x02);	Write_3Spi_date(0x34);

	//***********VCL  -2.5V*************//
	Write_3Spi_cmd(0xB2,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xB2,0x01);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xB2,0x02);	Write_3Spi_date(0x00);

	//**************VCL ratio*****************//
	Write_3Spi_cmd(0xB8,0x00);	Write_3Spi_date(0x24);
	Write_3Spi_cmd(0xB8,0x01);	Write_3Spi_date(0x24);
	Write_3Spi_cmd(0xB8,0x02);	Write_3Spi_date(0x24);


	//*************VGH 15V  (Free pump)*********//
	Write_3Spi_cmd(0xBF,0x00);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xB3,0x00);	Write_3Spi_date(0x0F);
	Write_3Spi_cmd(0xB3,0x01);	Write_3Spi_date(0x0F);
	Write_3Spi_cmd(0xB3,0x02);	Write_3Spi_date(0x0F);

	//*************VGH ratio*****************//
	Write_3Spi_cmd(0xB9,0x00);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xB9,0x01);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xB9,0x02);	Write_3Spi_date(0x34);

	//***************VGL_REG -10V**************//
	Write_3Spi_cmd(0xB5,0x00);	Write_3Spi_date(0x08);
	Write_3Spi_cmd(0xB5,0x01);	Write_3Spi_date(0x08);
	Write_3Spi_cmd(0xB5,0x02);	Write_3Spi_date(0x08);

	Write_3Spi_cmd(0xC2,0x00);	Write_3Spi_date(0x03);
		 
	//*****************VGLX ratio***************//
	Write_3Spi_cmd(0xBA,0x00);	Write_3Spi_date(0x24);
	Write_3Spi_cmd(0xBA,0x01);	Write_3Spi_date(0x24);
	Write_3Spi_cmd(0xBA,0x02);	Write_3Spi_date(0x24);

	//*************VGMP/VGSP 4.5V/0V*************//
	Write_3Spi_cmd(0xBC,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xBC,0x01);	Write_3Spi_date(0x78);
	Write_3Spi_cmd(0xBC,0x02);	Write_3Spi_date(0x00);

	//************VGMN/VGSN -4.5V/0V****************//
	Write_3Spi_cmd(0xBD,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xBD,0x01);	Write_3Spi_date(0x78);
	Write_3Spi_cmd(0xBD,0x02);	Write_3Spi_date(0x00);

	//************VCOM  -1.25V****************//
	Write_3Spi_cmd(0xBE,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xBE,0x01);	Write_3Spi_date(0x64);    //67--------------

	//************Gamma Setting******************//
	Write_3Spi_cmd(0xD1,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x01);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD1,0x02);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x03);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD1,0x04);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x05);	Write_3Spi_date(0x3a);
	Write_3Spi_cmd(0xD1,0x06);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x07);	Write_3Spi_date(0x4A);
	Write_3Spi_cmd(0xD1,0x08);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x09);	Write_3Spi_date(0x5c);
	Write_3Spi_cmd(0xD1,0x0A);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x0B);	Write_3Spi_date(0x81);
	Write_3Spi_cmd(0xD1,0x0C);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x0D);	Write_3Spi_date(0xA6);
	Write_3Spi_cmd(0xD1,0x0E);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x0F);	Write_3Spi_date(0xE5);
	Write_3Spi_cmd(0xD1,0x10);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD1,0x11);	Write_3Spi_date(0x13);
	Write_3Spi_cmd(0xD1,0x12);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD1,0x13);	Write_3Spi_date(0x54);
	Write_3Spi_cmd(0xD1,0x14);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD1,0x15);	Write_3Spi_date(0x82);
	Write_3Spi_cmd(0xD1,0x16);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD1,0x17);	Write_3Spi_date(0xCA);
	Write_3Spi_cmd(0xD1,0x18);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x19);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD1,0x1A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x1B);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD1,0x1C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x1D);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD1,0x1E);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x1F);	Write_3Spi_date(0x67);
	Write_3Spi_cmd(0xD1,0x20);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x21);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xD1,0x22);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x23);	Write_3Spi_date(0xA4);
	Write_3Spi_cmd(0xD1,0x24);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x25);	Write_3Spi_date(0xB7);
	Write_3Spi_cmd(0xD1,0x26);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x27);	Write_3Spi_date(0xCF);
	Write_3Spi_cmd(0xD1,0x28);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x29);	Write_3Spi_date(0xDE);
	Write_3Spi_cmd(0xD1,0x2A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x2B);	Write_3Spi_date(0xF2);
	Write_3Spi_cmd(0xD1,0x2C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD1,0x2D);	Write_3Spi_date(0xFE);
	Write_3Spi_cmd(0xD1,0x2E);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD1,0x2F);	Write_3Spi_date(0x10);
	Write_3Spi_cmd(0xD1,0x30);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD1,0x31);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD1,0x32);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD1,0x33);	Write_3Spi_date(0x6D);
					 
	Write_3Spi_cmd(0xD2,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x01);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD2,0x02);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x03);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD2,0x04);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x05);	Write_3Spi_date(0x3A);
	Write_3Spi_cmd(0xD2,0x06);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x07);	Write_3Spi_date(0x4A);
	Write_3Spi_cmd(0xD2,0x08);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x09);	Write_3Spi_date(0x5C);
	Write_3Spi_cmd(0xD2,0x0A);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x0B);	Write_3Spi_date(0x81);
	Write_3Spi_cmd(0xD2,0x0C);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x0D);	Write_3Spi_date(0xA6);
	Write_3Spi_cmd(0xD2,0x0E);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x0F);	Write_3Spi_date(0xE5);
	Write_3Spi_cmd(0xD2,0x10);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD2,0x11);	Write_3Spi_date(0x13);
	Write_3Spi_cmd(0xD2,0x12);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD2,0x13);	Write_3Spi_date(0x54);
	Write_3Spi_cmd(0xD2,0x14);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD2,0x15);	Write_3Spi_date(0x82);
	Write_3Spi_cmd(0xD2,0x16);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD2,0x17);	Write_3Spi_date(0xCA);
	Write_3Spi_cmd(0xD2,0x18);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x19);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD2,0x1A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x1B);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD2,0x1C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x1D);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD2,0x1E);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x1F);	Write_3Spi_date(0x67);
	Write_3Spi_cmd(0xD2,0x20);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x21);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xD2,0x22);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x23);	Write_3Spi_date(0xA4);
	Write_3Spi_cmd(0xD2,0x24);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x25);	Write_3Spi_date(0xB7);
	Write_3Spi_cmd(0xD2,0x26);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x27);	Write_3Spi_date(0xCF);
	Write_3Spi_cmd(0xD2,0x28);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x29);	Write_3Spi_date(0xDE);
	Write_3Spi_cmd(0xD2,0x2A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x2B);	Write_3Spi_date(0xF2);
	Write_3Spi_cmd(0xD2,0x2C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD2,0x2D);	Write_3Spi_date(0xFE);
	Write_3Spi_cmd(0xD2,0x2E);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD2,0x2F);	Write_3Spi_date(0x10);
	Write_3Spi_cmd(0xD2,0x30);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD2,0x31);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD2,0x32);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD2,0x33);	Write_3Spi_date(0x6D);

	Write_3Spi_cmd(0xD3,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x01);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD3,0x02);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x03);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD3,0x04);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x05);	Write_3Spi_date(0x3A);
	Write_3Spi_cmd(0xD3,0x06);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x07);	Write_3Spi_date(0x4A);
	Write_3Spi_cmd(0xD3,0x08);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x09);	Write_3Spi_date(0x5C);
	Write_3Spi_cmd(0xD3,0x0A);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x0B);	Write_3Spi_date(0x81);
	Write_3Spi_cmd(0xD3,0x0C);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x0D);	Write_3Spi_date(0xA6);
	Write_3Spi_cmd(0xD3,0x0E);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x0F);	Write_3Spi_date(0xE5);
	Write_3Spi_cmd(0xD3,0x10);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD3,0x11);	Write_3Spi_date(0x13);
	Write_3Spi_cmd(0xD3,0x12);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD3,0x13);	Write_3Spi_date(0x54);
	Write_3Spi_cmd(0xD3,0x14);	Write_3Spi_date(0x01); 
	Write_3Spi_cmd(0xD3,0x15);	Write_3Spi_date(0x82);
	Write_3Spi_cmd(0xD3,0x16);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD3,0x17);	Write_3Spi_date(0xCA);
	Write_3Spi_cmd(0xD3,0x18);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x19);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD3,0x1A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x1B);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD3,0x1C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x1D);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD3,0x1E);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x1F);	Write_3Spi_date(0x67);
	Write_3Spi_cmd(0xD3,0x20);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x21);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xD3,0x22);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x23);	Write_3Spi_date(0xA4);
	Write_3Spi_cmd(0xD3,0x24);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x25);	Write_3Spi_date(0xB7);
	Write_3Spi_cmd(0xD3,0x26);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x27);	Write_3Spi_date(0xCF);
	Write_3Spi_cmd(0xD3,0x28);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x29);	Write_3Spi_date(0xDE);
	Write_3Spi_cmd(0xD3,0x2A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x2B);	Write_3Spi_date(0xF2);
	Write_3Spi_cmd(0xD3,0x2C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD3,0x2D);	Write_3Spi_date(0xFE);
	Write_3Spi_cmd(0xD3,0x2E);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD3,0x2F);	Write_3Spi_date(0x10);
	Write_3Spi_cmd(0xD3,0x30);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD3,0x31);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD3,0x32);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD3,0x33);	Write_3Spi_date(0x6D);

	Write_3Spi_cmd(0xD4,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x01);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD4,0x02);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x03);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD4,0x04);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x05);	Write_3Spi_date(0x3A);
	Write_3Spi_cmd(0xD4,0x06);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x07);	Write_3Spi_date(0x4A);
	Write_3Spi_cmd(0xD4,0x08);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x09);	Write_3Spi_date(0x5C);
	Write_3Spi_cmd(0xD4,0x0A);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x0B);	Write_3Spi_date(0x81);
	Write_3Spi_cmd(0xD4,0x0C);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x0D);	Write_3Spi_date(0xA6);
	Write_3Spi_cmd(0xD4,0x0E);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x0F);	Write_3Spi_date(0xE5);
	Write_3Spi_cmd(0xD4,0x10);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD4,0x11);	Write_3Spi_date(0x13);
	Write_3Spi_cmd(0xD4,0x12);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD4,0x13);	Write_3Spi_date(0x54);
	Write_3Spi_cmd(0xD4,0x14);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD4,0x15);	Write_3Spi_date(0x82);
	Write_3Spi_cmd(0xD4,0x16);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD4,0x17);	Write_3Spi_date(0xCA);
	Write_3Spi_cmd(0xD4,0x18);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x19);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD4,0x1A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x1B);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD4,0x1C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x1D);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD4,0x1E);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x1F);	Write_3Spi_date(0x67);
	Write_3Spi_cmd(0xD4,0x20);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x21);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xD4,0x22);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x23);	Write_3Spi_date(0xA4);
	Write_3Spi_cmd(0xD4,0x24);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x25);	Write_3Spi_date(0xB7);
	Write_3Spi_cmd(0xD4,0x26);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x27);	Write_3Spi_date(0xCF);
	Write_3Spi_cmd(0xD4,0x28);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x29);	Write_3Spi_date(0xDE);
	Write_3Spi_cmd(0xD4,0x2A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x2B);	Write_3Spi_date(0xF2);
	Write_3Spi_cmd(0xD4,0x2C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD4,0x2D);	Write_3Spi_date(0xFE);
	Write_3Spi_cmd(0xD4,0x2E);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD4,0x2F);	Write_3Spi_date(0x10);
	Write_3Spi_cmd(0xD4,0x30);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD4,0x31);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD4,0x32);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD4,0x33);	Write_3Spi_date(0x6D);

	Write_3Spi_cmd(0xD5,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x01);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD5,0x02);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x03);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD5,0x04);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x05);	Write_3Spi_date(0x3A);
	Write_3Spi_cmd(0xD5,0x06);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x07);	Write_3Spi_date(0x4A);
	Write_3Spi_cmd(0xD5,0x08);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x09);	Write_3Spi_date(0x5C);
	Write_3Spi_cmd(0xD5,0x0A);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x0B);	Write_3Spi_date(0x81);
	Write_3Spi_cmd(0xD5,0x0C);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x0D);	Write_3Spi_date(0xA6);
	Write_3Spi_cmd(0xD5,0x0E);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x0F);	Write_3Spi_date(0xE5);
	Write_3Spi_cmd(0xD5,0x10);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD5,0x11);	Write_3Spi_date(0x13);
	Write_3Spi_cmd(0xD5,0x12);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD5,0x13);	Write_3Spi_date(0x54);
	Write_3Spi_cmd(0xD5,0x14);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD5,0x15);	Write_3Spi_date(0x82);
	Write_3Spi_cmd(0xD5,0x16);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD5,0x17);	Write_3Spi_date(0xCA);
	Write_3Spi_cmd(0xD5,0x18);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x19);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD5,0x1A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x1B);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD5,0x1C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x1D);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD5,0x1E);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x1F);	Write_3Spi_date(0x67);
	Write_3Spi_cmd(0xD5,0x20);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x21);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xD5,0x22);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x23);	Write_3Spi_date(0xA4);
	Write_3Spi_cmd(0xD5,0x24);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x25);	Write_3Spi_date(0xB7);
	Write_3Spi_cmd(0xD5,0x26);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x27);	Write_3Spi_date(0xCF);
	Write_3Spi_cmd(0xD5,0x28);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x29);	Write_3Spi_date(0xDE);
	Write_3Spi_cmd(0xD5,0x2A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x2B);	Write_3Spi_date(0xF2);
	Write_3Spi_cmd(0xD5,0x2C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD5,0x2D);	Write_3Spi_date(0xFE);
	Write_3Spi_cmd(0xD5,0x2E);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD5,0x2F);	Write_3Spi_date(0x10);
	Write_3Spi_cmd(0xD5,0x30);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD5,0x31);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD5,0x32);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD5,0x33);	Write_3Spi_date(0x6D);

	Write_3Spi_cmd(0xD6,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x01);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD6,0x02);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x03);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD6,0x04);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x05);	Write_3Spi_date(0x3A);
	Write_3Spi_cmd(0xD6,0x06);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x07);	Write_3Spi_date(0x4A);
	Write_3Spi_cmd(0xD6,0x08);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x09);	Write_3Spi_date(0x5C);
	Write_3Spi_cmd(0xD6,0x0A);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x0B);	Write_3Spi_date(0x81);
	Write_3Spi_cmd(0xD6,0x0C);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x0D);	Write_3Spi_date(0xA6);
	Write_3Spi_cmd(0xD6,0x0E);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x0F);	Write_3Spi_date(0xE5);
	Write_3Spi_cmd(0xD6,0x10);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD6,0x11);	Write_3Spi_date(0x13);
	Write_3Spi_cmd(0xD6,0x12);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD6,0x13);	Write_3Spi_date(0x54);
	Write_3Spi_cmd(0xD6,0x14);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD6,0x15);	Write_3Spi_date(0x82);
	Write_3Spi_cmd(0xD6,0x16);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD6,0x17);	Write_3Spi_date(0xCA);
	Write_3Spi_cmd(0xD6,0x18);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x19);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xD6,0x1A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x1B);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xD6,0x1C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x1D);	Write_3Spi_date(0x34);
	Write_3Spi_cmd(0xD6,0x1E);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x1F);	Write_3Spi_date(0x67);
	Write_3Spi_cmd(0xD6,0x20);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x21);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xD6,0x22);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x23);	Write_3Spi_date(0xA4);
	Write_3Spi_cmd(0xD6,0x24);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x25);	Write_3Spi_date(0xB7);
	Write_3Spi_cmd(0xD6,0x26);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x27);	Write_3Spi_date(0xCF);
	Write_3Spi_cmd(0xD6,0x28);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x29);	Write_3Spi_date(0xDE);
	Write_3Spi_cmd(0xD6,0x2A);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x2B);	Write_3Spi_date(0xF2);
	Write_3Spi_cmd(0xD6,0x2C);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xD6,0x2D);	Write_3Spi_date(0xFE);
	Write_3Spi_cmd(0xD6,0x2E);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD6,0x2F);	Write_3Spi_date(0x10);
	Write_3Spi_cmd(0xD6,0x30);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD6,0x31);	Write_3Spi_date(0x33);
	Write_3Spi_cmd(0xD6,0x32);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xD6,0x33);	Write_3Spi_date(0x6D);


	//**************LV2 Page 0 enable*************//
	Write_3Spi_cmd(0xF0,0x00);	Write_3Spi_date(0x55);
	Write_3Spi_cmd(0xF0,0x01);	Write_3Spi_date(0xAA);
	Write_3Spi_cmd(0xF0,0x02);	Write_3Spi_date(0x52);
	Write_3Spi_cmd(0xF0,0x03);	Write_3Spi_date(0x08);
	Write_3Spi_cmd(0xF0,0x04);	Write_3Spi_date(0x00);

	//*************480x800*********************//
//	Write_3Spi_cmd(0xB5,0x00);	Write_3Spi_date(0x50);

	//***************Display control**************//
	Write_3Spi_cmd(0xB1,0x00);	Write_3Spi_date(0xCC);
	Write_3Spi_cmd(0xB1,0x01);	Write_3Spi_date(0x00);

	//***************Source hold time*************//
	Write_3Spi_cmd(0xB6,0x00);	Write_3Spi_date(0x05);

	//**************Gate EQ control***************//
	Write_3Spi_cmd(0xB7,0x00);	Write_3Spi_date(0x70);
	Write_3Spi_cmd(0xB7,0x01);	Write_3Spi_date(0x70);

	//*************Source EQ control (Mode 2)******//
	Write_3Spi_cmd(0xB8,0x00);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xB8,0x01);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xB8,0x02);	Write_3Spi_date(0x03);
	Write_3Spi_cmd(0xB8,0x03);	Write_3Spi_date(0x03);
					
	//************Inversion mode  (2-dot)***********//
	Write_3Spi_cmd(0xBC,0x00);	Write_3Spi_date(0x02);
	Write_3Spi_cmd(0xBC,0x01);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0xBC,0x02);	Write_3Spi_date(0x00);
					 
	//***************Frame rate***************//      
	/*
	Write_3Spi_cmd(0xBD,0x00);	Write_3Spi_date(0x01);
	Write_3Spi_cmd(0xBD,0x01);	Write_3Spi_date(0x84);
	Write_3Spi_cmd(0xBD,0x02);	Write_3Spi_date(0x1C);  //0X1C
	Write_3Spi_cmd(0xBD,0x03);	Write_3Spi_date(0x1C);
	Write_3Spi_cmd(0xBD,0x04);	Write_3Spi_date(0x00);*/

	//********Timing control 4H w/ 4-Delayms *******//
	Write_3Spi_cmd(0xC9,0x00);	Write_3Spi_date(0xD0);
	Write_3Spi_cmd(0xC9,0x01);	Write_3Spi_date(0x02); 
	Write_3Spi_cmd(0xC9,0x02);	Write_3Spi_date(0x50);
	Write_3Spi_cmd(0xC9,0x03);	Write_3Spi_date(0x50);
	Write_3Spi_cmd(0xC9,0x04);	Write_3Spi_date(0x50);

	Write_3Spi_cmd(0x36,0x00);	Write_3Spi_date(0x00);
	Write_3Spi_cmd(0x35,0x00);	Write_3Spi_date(0x00);

	Write_3Spi_cmd(0x3A,0x00); Write_3Spi_date(0x77);
	Write_3Spi_cmd(0x11,0x00);
	rt_thread_mdelay(120);
	Write_3Spi_cmd(0x29,0x00);
	rt_thread_mdelay(10);
	Write_3Spi_cmd(0x2C,0x00);
    
    HAL_LTDC_SetAddress(&hltdc, 0x60000000, 0);
    
    while(1)
    {
        rt_thread_mdelay(10);
    }
}
